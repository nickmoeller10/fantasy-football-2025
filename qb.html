<script>
// Test data - remove this once qb-data.js works
const testQBData = [
    {name: "Josh Allen", team: "BUF", age: 29, ageScore: 10, injury: "Healthy", healthScore: 10, points2024: 445, points2024Score: 10, ppg2024: 26.2, ppg2024Score: 10, projPoints2025: 377, projPointsScore: 10, projPPG2025: 22.2, projPPGScore: 10, olRank: 8, offProjRank: 10, wrCorpsRank: 7},
    {name: "Lamar Jackson", team: "BAL", age: 28, ageScore: 10, injury: "Healthy", healthScore: 10, points2024: 421, points2024Score: 10, ppg2024: 24.8, ppg2024Score: 10, projPoints2025: 376, projPointsScore: 10, projPPG2025: 22.1, projPPGScore: 10, olRank: 7, offProjRank: 10, wrCorpsRank: 8},
    {name: "Dak Prescott", team: "DAL", age: 31, ageScore: 8, injury: "Healthy", healthScore: 7, points2024: 245, points2024Score: 5, ppg2024: 14.4, ppg2024Score: 4, projPoints2025: 292, projPointsScore: 6, projPPG2025: 17.2, projPPGScore: 6, olRank: 6, offProjRank: 6, wrCorpsRank: 7}
];

// Copy the utility functions from index.html
function getScoreClass(score) {
    if (score >= 8) return 'score-high';
    if (score >= 5) return 'score-medium';
    return 'score-low';
}

function getInjuryClass(status) {
    if (status === 'Healthy') return 'healthy';
    if (status.includes('Questionable') || status.includes('Day-to-Day')) return 'questionable';
    return 'injured';
}

function calculateFinalScore(player, scoreFields) {
    const scores = scoreFields.map(field => player[field] || 1);
    return Math.round(scores.reduce((sum, score) => sum + score, 0) / scores.length * 10) / 10;
}

function testPopulateQBData() {
    const tbody = document.getElementById('qb-data');
    if (!tbody) {
        console.log('qb-data element not found');
        return;
    }
    
    console.log('Populating test QB data...');
    
    // Calculate final scores for test data
    const scoreFields = ['ageScore', 'healthScore', 'points2024Score', 'ppg2024Score', 'projPointsScore', 'projPPGScore', 'olRank', 'offProjRank', 'wrCorpsRank'];
    
    const sortedQBs = testQBData.map(qb => ({
        ...qb,
        finalScore: calculateFinalScore(qb, scoreFields)
    })).sort((a, b) => b.finalScore - a.finalScore);
    
    tbody.innerHTML = sortedQBs.map(qb => `
        <tr>
            <td class="player-name">${qb.name}</td>
            <td class="team">${qb.team}</td>
            <td>${qb.age}</td>
            <td class="${getScoreClass(qb.ageScore)}">${qb.ageScore}</td>
            <td><span class="injury-status ${getInjuryClass(qb.injury)}">${qb.injury}</span></td>
            <td class="${getScoreClass(qb.healthScore)}">${qb.healthScore}</td>
            <td>${qb.points2024}</td>
            <td class="${getScoreClass(qb.points2024Score)}">${qb.points2024Score}</td>
            <td>${qb.ppg2024}</td>
            <td class="${getScoreClass(qb.ppg2024Score)}">${qb.ppg2024Score}</td>
            <td>${qb.projPoints2025}</td>
            <td class="${getScoreClass(qb.projPointsScore)}">${qb.projPointsScore}</td>
            <td>${qb.projPPG2025}</td>
            <td class="${getScoreClass(qb.projPPGScore)}">${qb.projPPGScore}</td>
            <td class="${getScoreClass(qb.olRank)}">${qb.olRank}</td>
            <td class="${getScoreClass(qb.offProjRank)}">${qb.offProjRank}</td>
            <td class="${getScoreClass(qb.wrCorpsRank)}">${qb.wrCorpsRank}</td>
            <td class="final-score">${qb.finalScore}</td>
        </tr>
    `).join('');
    
    console.log(`Test data populated: ${sortedQBs.length} QBs`);
}

// Run test after a delay
setTimeout(testPopulateQBData, 1500);
</script>
